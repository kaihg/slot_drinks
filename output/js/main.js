var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var App;
(function (App) {
    var Constants = /** @class */ (function () {
        function Constants() {
        }
        Constants.SYMBOL_WIDTH = 200;
        Constants.SYMBOL_HEIGHT = 100;
        return Constants;
    }());
    App.Constants = Constants;
})(App || (App = {}));
var App;
(function (App) {
    var Main = /** @class */ (function () {
        function Main() {
            this.initPIXI();
            this.startLoading();
        }
        Main.prototype.initPIXI = function () {
            this.app = new PIXI.Application(window.innerWidth, window.innerHeight, { backgroundColor: 0x1099bb });
            document.body.appendChild(this.app.view);
            if (window.addEventListener) {
                window.addEventListener("resize", this.onResize.bind(this), true);
            }
        };
        Main.prototype.onResize = function () {
            this.app.renderer.resize(window.innerWidth, window.innerHeight);
            this.reelView.x = this.app.screen.width / 2;
            this.reelView.y = this.app.screen.height / 2;
            this.spinBtn.x = this.reelView.x;
            this.spinBtn.y = this.reelView.y + App.Constants.SYMBOL_HEIGHT;
        };
        Main.prototype.startLoading = function () {
            var _this = this;
            var loadingView = new view.LoadingView();
            loadingView.x = this.app.screen.width / 2;
            loadingView.y = this.app.screen.height / 2;
            this.app.stage.addChild(loadingView);
            PIXI.loader
                .on("progress", function (loader, resource) { loadingView.updateProgress(loader.progress); })
                .add("shops", "resource/shops.json")
                .load(function () {
                loadingView.parent.removeChild(loadingView);
                _this.onLoaded();
            });
        };
        Main.prototype.onLoaded = function () {
            this.initReelView(PIXI.loader.resources.shops.data);
            this.initSpinButton();
        };
        Main.prototype.initReelView = function (shops) {
            console.log(shops);
            var reel = new view.ReelView(shops);
            reel.x = this.app.screen.width / 2;
            reel.y = this.app.screen.height / 2;
            this.app.stage.addChild(reel);
            this.reelView = reel;
        };
        Main.prototype.initSpinButton = function () {
            var btn = new view.Button("開始");
            btn.anchor.set(0.5);
            btn.x = this.reelView.x;
            btn.y = this.reelView.y + App.Constants.SYMBOL_HEIGHT;
            btn.buttonWidth = App.Constants.SYMBOL_WIDTH;
            btn.buttonHeight = 55;
            // btn.x = this.app.screen.width - 64;
            // btn.y = this.app.screen.height - 48;
            btn.interactive = true;
            btn.on('pointerup', this.spin.bind(this));
            this.spinBtn = btn;
            this.app.stage.addChild(btn);
            // let testBtn = new view.Button();
            // testBtn.buttonWidth = App.Constants.SYMBOL_WIDTH;
            // testBtn.buttonHeight = 75;
            // // testBtn.redraw();
            // testBtn.x = this.reelView.x;
            // testBtn.y = this.reelView.y + App.Constants.SYMBOL_HEIGHT *2;
            // this.app.stage.addChild(testBtn);
        };
        Main.prototype.spin = function () {
            this.reelView.onSpin();
        };
        return Main;
    }());
    App.Main = Main;
})(App || (App = {}));
var view;
(function (view) {
    var HoverType;
    (function (HoverType) {
        HoverType[HoverType["type1"] = 0] = "type1";
    })(HoverType = view.HoverType || (view.HoverType = {}));
    var ButtonHoverEffect = /** @class */ (function () {
        function ButtonHoverEffect() {
        }
        ButtonHoverEffect.onHover = function (type, tweenObj, isOverIn) {
            switch (type) {
                case HoverType.type1:
                    ButtonHoverEffect.alphaVisible(tweenObj, isOverIn);
                    break;
            }
        };
        ButtonHoverEffect.alphaVisible = function (tweenObj, isOverIn) {
            var sec = 0.5;
            TweenLite.killTweensOf(tweenObj);
            if (isOverIn) {
                TweenLite.to(tweenObj, sec, { alpha: 1 });
            }
            else {
                TweenLite.to(tweenObj, sec, { alpha: 0, onComplete: function () { tweenObj.visible = false; } });
            }
        };
        return ButtonHoverEffect;
    }());
    view.ButtonHoverEffect = ButtonHoverEffect;
})(view || (view = {}));
var view;
(function (view) {
    var Button = /** @class */ (function (_super) {
        __extends(Button, _super);
        function Button(text) {
            if (text === void 0) { text = "Button"; }
            var _this = _super.call(this) || this;
            _this.hoverType = view.HoverType.type1;
            _this.frameColor = 0xffffff;
            _this.bgColor = 0x0011ff;
            _this.effectSec = 0.5;
            _this.bgView = new PIXI.Graphics();
            _this.effect = new PIXI.Sprite(PIXI.Texture.WHITE);
            _this.effect.anchor.set(0.5);
            _this.effect.visible = false;
            _this.effect.alpha = 0;
            _this.label = new PIXI.Text(text, { fill: _this.frameColor });
            _this.label.anchor.set(0.5);
            _this.addChild(_this.bgView, _this.effect, _this.label);
            _this.drawNormalSytle();
            // set interactive
            _this.interactive = true;
            _this.buttonMode = true;
            _this.on("pointerover", _this.onButtonOver);
            _this.on("pointerout", _this.onButtonOut);
            return _this;
        }
        Button.prototype.drawNormalSytle = function () {
            // let width = this.width;
            // let height = this.height;
            var padding = 10;
            var width = this._buttonWidth || this.label.width + padding;
            var height = this._buttonHeight || this.label.height + padding;
            // let startX =  -width * 0.5;
            // let startY = -height * 0.5;
            var startX = -width * 0.5;
            var startY = -height * 0.5;
            var graph = this.bgView;
            graph.clear();
            graph.beginFill(this.bgColor);
            // graph.drawRect(startX,startY,width,height);
            // graph.endFill();
            graph.lineStyle(5, this.frameColor);
            graph.moveTo(startX, startY);
            graph.lineTo(startX + width, startY);
            graph.lineTo(startX + width, startY + height);
            graph.lineTo(startX, startY + height);
            graph.lineTo(startX, startY);
            graph.endFill();
        };
        Object.defineProperty(Button.prototype, "buttonWidth", {
            set: function (width) {
                this._buttonWidth = Math.max(width, this.label.width);
                this.redraw();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Button.prototype, "buttonHeight", {
            set: function (height) {
                this._buttonHeight = Math.max(height, this.label.height);
                this.redraw();
            },
            enumerable: true,
            configurable: true
        });
        Button.prototype.redraw = function () {
            this.drawNormalSytle();
        };
        Button.prototype.onButtonOver = function () {
            this.effect.width = this._buttonWidth;
            this.effect.height = this._buttonHeight;
            this.effect.visible = true;
            this.effect.tint = this.frameColor;
            view.ButtonHoverEffect.onHover(this.hoverType, this.effect, true);
            this.label.style.fill = this.bgColor;
        };
        Button.prototype.onButtonOut = function () {
            view.ButtonHoverEffect.onHover(this.hoverType, this.effect, false);
            this.label.style.fill = this.frameColor;
        };
        return Button;
    }(PIXI.Sprite));
    view.Button = Button;
})(view || (view = {}));
var view;
(function (view) {
    var LoadingView = /** @class */ (function (_super) {
        __extends(LoadingView, _super);
        function LoadingView() {
            var _this = _super.call(this) || this;
            _this.progress = 0;
            _this.color = 0xaabc13;
            return _this;
        }
        LoadingView.prototype.updateProgress = function (p) {
            var percent = p;
            this.progress = percent;
            this.clear();
            this.lineStyle(10, this.color);
            // this.drawCircle(0, 0, 2 * Math.PI * percent);
            this.arc(0, 0, 50, 0, 2 * Math.PI * percent);
            this.endFill();
        };
        return LoadingView;
    }(PIXI.Graphics));
    view.LoadingView = LoadingView;
})(view || (view = {}));
var view;
(function (view) {
    var ReelView = /** @class */ (function (_super) {
        __extends(ReelView, _super);
        // private _mask: PIXI.DisplayObject;
        function ReelView(shops) {
            var _this = _super.call(this) || this;
            _this.tempIds = [0, 1, 2];
            _this.shops = shops;
            var width = App.Constants.SYMBOL_WIDTH;
            var height = App.Constants.SYMBOL_HEIGHT;
            _this.frame = new PIXI.Graphics();
            _this.frame.lineStyle(10, 0x000000);
            _this.frame.drawRect(-width * 0.5, -height * 0.5, width, height);
            _this.frame.endFill();
            // mask
            var mask = new PIXI.Graphics();
            mask.beginFill(0xFFFFFF);
            mask.drawRect(-width * 0.5, -height * 0.5, width, height);
            mask.endFill();
            // wheel
            var wheel = new view.WheelView(shops);
            wheel.mask = mask;
            wheel.setIds(_this.tempIds);
            _this.wheel = wheel;
            _this.addChild(wheel, mask, _this.frame);
            _this.updateShop(_this.tempIds);
            return _this;
        }
        ReelView.prototype.updateShop = function (shopId) {
            this.wheel.setIds(shopId);
        };
        ReelView.prototype.onSpin = function () {
            if (this.spining) {
                return;
            }
            this.spining = true;
            var dampingStartSec = 0.5;
            TweenMax.to(this.wheel.position, dampingStartSec, { y: -40, yoyo: true, repeat: 1 });
            TweenMax.fromTo(this.wheel.position, 0.2, { y: 0 }, { delay: dampingStartSec * 2, y: App.Constants.SYMBOL_HEIGHT, repeat: 10, ease: Linear.easeNone, onRepeat: this.swapId, onRepeatScope: this, onComplete: this.onSpinComplete, onCompleteScope: this });
        };
        ReelView.prototype.randomId = function () {
            return Math.floor(Math.random() * this.shops.length);
        };
        ReelView.prototype.swapId = function () {
            this.tempIds.unshift(this.randomId());
            this.updateShop(this.tempIds);
        };
        ReelView.prototype.onSpinComplete = function () {
            this.spining = false;
            this.tempIds.unshift(this.randomId());
            this.tempIds.unshift(this.randomId());
            this.updateShop(this.tempIds);
            TweenLite.fromTo(this.wheel.position, 1, { y: -App.Constants.SYMBOL_HEIGHT }, { y: 0, ease: Back.easeOut });
        };
        return ReelView;
    }(PIXI.Sprite));
    view.ReelView = ReelView;
})(view || (view = {}));
var view;
(function (view) {
    var WheelView = /** @class */ (function (_super) {
        __extends(WheelView, _super);
        function WheelView(shops) {
            var _this = _super.call(this, PIXI.Texture.EMPTY) || this;
            _this.shops = shops;
            for (var i = 0; i < 3; i++) {
                var symbolText = new PIXI.Text("", { fill: "0x000000" });
                symbolText.anchor.set(0.5);
                var bg = new PIXI.Sprite(PIXI.Texture.WHITE);
                bg.width = App.Constants.SYMBOL_WIDTH;
                bg.height = App.Constants.SYMBOL_HEIGHT;
                bg.anchor.set(0.5);
                var container = new PIXI.Container();
                container.addChild(bg, symbolText);
                container.y = (i - 1) * App.Constants.SYMBOL_HEIGHT;
                _this.addChild(container);
            }
            return _this;
        }
        WheelView.prototype.setIds = function (ids) {
            var _this = this;
            this.children.forEach(function (child, i) {
                var textView = child.getChildAt(1);
                textView.text = _this.shops[ids[i]];
            });
        };
        return WheelView;
    }(PIXI.Sprite));
    view.WheelView = WheelView;
})(view || (view = {}));

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9Db25zdGFudHMudHMiLCJzcmMvTWFpbi50cyIsInNyYy9lZmZlY3QvQnV0dG9uSG92ZXJFZmZlY3QudHMiLCJzcmMvdmlldy9CdXR0b24udHMiLCJzcmMvdmlldy9Mb2FkaW5nVmlldy50cyIsInNyYy92aWV3L1JlZWxWaWV3LnRzIiwic3JjL3ZpZXcvV2hlZWxWaWV3LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxJQUFPLEdBQUcsQ0FLVDtBQUxELFdBQU8sR0FBRztJQUNOO1FBQUE7UUFHQSxDQUFDO1FBRmlCLHNCQUFZLEdBQUcsR0FBRyxDQUFDO1FBQ25CLHVCQUFhLEdBQUcsR0FBRyxDQUFDO1FBQ3RDLGdCQUFDO0tBSEQsQUFHQyxJQUFBO0lBSFksYUFBUyxZQUdyQixDQUFBO0FBQ0wsQ0FBQyxFQUxNLEdBQUcsS0FBSCxHQUFHLFFBS1Q7QUNMRCxJQUFPLEdBQUcsQ0FtR1Q7QUFuR0QsV0FBTyxHQUFHO0lBQ047UUFPSTtZQUVJLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7UUFFeEIsQ0FBQztRQUVPLHVCQUFRLEdBQWhCO1lBQ0ksSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsV0FBVyxFQUFFLEVBQUUsZUFBZSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDdEcsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN6QyxJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTtnQkFDekIsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQzthQUNyRTtRQUNMLENBQUM7UUFFRCx1QkFBUSxHQUFSO1lBQ0ksSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRWhFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7WUFDNUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUU3QyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNqQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQztRQUNuRSxDQUFDO1FBRUQsMkJBQVksR0FBWjtZQUFBLGlCQWVDO1lBZEcsSUFBSSxXQUFXLEdBQUcsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDekMsV0FBVyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQzFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUUzQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFckMsSUFBSSxDQUFDLE1BQU07aUJBQ04sRUFBRSxDQUFDLFVBQVUsRUFBRSxVQUFDLE1BQTJCLEVBQUUsUUFBK0IsSUFBTyxXQUFXLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQSxDQUFDLENBQUMsQ0FBQztpQkFDakksR0FBRyxDQUFDLE9BQU8sRUFBRSxxQkFBcUIsQ0FBQztpQkFDbkMsSUFBSSxDQUFDO2dCQUNGLFdBQVcsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUM1QyxLQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDcEIsQ0FBQyxDQUFDLENBQUM7UUFFWCxDQUFDO1FBRUQsdUJBQVEsR0FBUjtZQUNJLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUMxQixDQUFDO1FBRUQsMkJBQVksR0FBWixVQUFhLEtBQWU7WUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuQixJQUFJLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQ25DLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUVwQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFOUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDekIsQ0FBQztRQUVELDZCQUFjLEdBQWQ7WUFDSSxJQUFJLEdBQUcsR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDaEMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDcEIsR0FBRyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUN4QixHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDO1lBQ3RELEdBQUcsQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUM7WUFDN0MsR0FBRyxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUM7WUFDdEIsc0NBQXNDO1lBQ3RDLHVDQUF1QztZQUN2QyxHQUFHLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUN2QixHQUFHLENBQUMsRUFBRSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBRTFDLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO1lBRW5CLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUc3QixtQ0FBbUM7WUFDbkMsb0RBQW9EO1lBQ3BELDZCQUE2QjtZQUM3Qix1QkFBdUI7WUFFdkIsK0JBQStCO1lBQy9CLGdFQUFnRTtZQUNoRSxvQ0FBb0M7UUFDeEMsQ0FBQztRQUVELG1CQUFJLEdBQUo7WUFDSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQzNCLENBQUM7UUFHTCxXQUFDO0lBQUQsQ0FqR0EsQUFpR0MsSUFBQTtJQWpHWSxRQUFJLE9BaUdoQixDQUFBO0FBQ0wsQ0FBQyxFQW5HTSxHQUFHLEtBQUgsR0FBRyxRQW1HVDtBQ25HRCxJQUFPLElBQUksQ0FnQ1Y7QUFoQ0QsV0FBTyxJQUFJO0lBQ1AsSUFBWSxTQUVYO0lBRkQsV0FBWSxTQUFTO1FBQ2pCLDJDQUFLLENBQUE7SUFDVCxDQUFDLEVBRlcsU0FBUyxHQUFULGNBQVMsS0FBVCxjQUFTLFFBRXBCO0lBRUQ7UUFBQTtRQTBCQSxDQUFDO1FBeEJpQix5QkFBTyxHQUFyQixVQUFzQixJQUFlLEVBQUUsUUFBNEIsRUFBRSxRQUFpQjtZQUVsRixRQUFRLElBQUksRUFBRTtnQkFDVixLQUFLLFNBQVMsQ0FBQyxLQUFLO29CQUNoQixpQkFBaUIsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO29CQUNuRCxNQUFNO2FBRWI7UUFFTCxDQUFDO1FBR2MsOEJBQVksR0FBM0IsVUFBNEIsUUFBNEIsRUFBRSxRQUFpQjtZQUN2RSxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUM7WUFDZCxTQUFTLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRWpDLElBQUksUUFBUSxFQUFFO2dCQUNWLFNBQVMsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQzdDO2lCQUFNO2dCQUNILFNBQVMsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsVUFBVSxFQUFFLGNBQVEsUUFBUSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQzdGO1FBRUwsQ0FBQztRQUVMLHdCQUFDO0lBQUQsQ0ExQkEsQUEwQkMsSUFBQTtJQTFCWSxzQkFBaUIsb0JBMEI3QixDQUFBO0FBQ0wsQ0FBQyxFQWhDTSxJQUFJLEtBQUosSUFBSSxRQWdDVjtBQ2hDRCxJQUFPLElBQUksQ0E4R1Y7QUE5R0QsV0FBTyxJQUFJO0lBRVA7UUFBNEIsMEJBQVc7UUFtQm5DLGdCQUFZLElBQWU7WUFBZixxQkFBQSxFQUFBLGVBQWU7WUFBM0IsWUFDSSxpQkFBTyxTQXFCVjtZQXZDRCxlQUFTLEdBQWMsS0FBQSxTQUFTLENBQUMsS0FBSyxDQUFDO1lBR3ZDLGdCQUFVLEdBQUcsUUFBUSxDQUFDO1lBQ3RCLGFBQU8sR0FBRyxRQUFRLENBQUM7WUFRWCxlQUFTLEdBQUcsR0FBRyxDQUFDO1lBUXBCLEtBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFFbEMsS0FBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNsRCxLQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDNUIsS0FBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQzVCLEtBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUV0QixLQUFJLENBQUMsS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsS0FBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUM7WUFDNUQsS0FBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRTNCLEtBQUksQ0FBQyxRQUFRLENBQUMsS0FBSSxDQUFDLE1BQU0sRUFBRSxLQUFJLENBQUMsTUFBTSxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUVwRCxLQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7WUFFdkIsa0JBQWtCO1lBQ2xCLEtBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1lBQ3hCLEtBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQ3ZCLEtBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLEtBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUMxQyxLQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7O1FBQzVDLENBQUM7UUFFRCxnQ0FBZSxHQUFmO1lBQ0ksMEJBQTBCO1lBQzFCLDRCQUE0QjtZQUM1QixJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFDakIsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUM7WUFDNUQsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxPQUFPLENBQUM7WUFFL0QsOEJBQThCO1lBQzlCLDhCQUE4QjtZQUM5QixJQUFJLE1BQU0sR0FBRyxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7WUFDMUIsSUFBSSxNQUFNLEdBQUcsQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1lBRTNCLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7WUFDeEIsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ2QsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDOUIsOENBQThDO1lBQzlDLG1CQUFtQjtZQUVuQixLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7WUFFcEMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDN0IsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3JDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLEtBQUssRUFBRSxNQUFNLEdBQUcsTUFBTSxDQUFDLENBQUM7WUFDOUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLE1BQU0sQ0FBQyxDQUFDO1lBQ3RDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBRTdCLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUdwQixDQUFDO1FBRUQsc0JBQUksK0JBQVc7aUJBQWYsVUFBZ0IsS0FBYTtnQkFDekIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0RCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDbEIsQ0FBQzs7O1dBQUE7UUFFRCxzQkFBSSxnQ0FBWTtpQkFBaEIsVUFBaUIsTUFBYztnQkFDM0IsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUN6RCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDbEIsQ0FBQzs7O1dBQUE7UUFFRCx1QkFBTSxHQUFOO1lBQ0ksSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQzNCLENBQUM7UUFFRCw2QkFBWSxHQUFaO1lBQ0ksSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUN0QyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDO1lBRXhDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztZQUMzQixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO1lBR25DLEtBQUEsaUJBQWlCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUMsSUFBSSxDQUFDLE1BQU0sRUFBQyxJQUFJLENBQUMsQ0FBQztZQUUzRCxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUN6QyxDQUFDO1FBRUQsNEJBQVcsR0FBWDtZQUVJLEtBQUEsaUJBQWlCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUMsSUFBSSxDQUFDLE1BQU0sRUFBQyxLQUFLLENBQUMsQ0FBQztZQUU1RCxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUM1QyxDQUFDO1FBQ0wsYUFBQztJQUFELENBM0dBLEFBMkdDLENBM0cyQixJQUFJLENBQUMsTUFBTSxHQTJHdEM7SUEzR1ksV0FBTSxTQTJHbEIsQ0FBQTtBQUNMLENBQUMsRUE5R00sSUFBSSxLQUFKLElBQUksUUE4R1Y7QUM5R0QsSUFBTyxJQUFJLENBc0JWO0FBdEJELFdBQU8sSUFBSTtJQUNQO1FBQWlDLCtCQUFhO1FBSzFDO1lBQUEsWUFDSSxpQkFBTyxTQUNWO1lBTE8sY0FBUSxHQUFXLENBQUMsQ0FBQztZQUM3QixXQUFLLEdBQVcsUUFBUSxDQUFBOztRQUl4QixDQUFDO1FBRU0sb0NBQWMsR0FBckIsVUFBc0IsQ0FBUztZQUMzQixJQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7WUFDaEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7WUFFeEIsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ2IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9CLGdEQUFnRDtZQUNoRCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUMsQ0FBQztZQUM3QyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDbkIsQ0FBQztRQUVMLGtCQUFDO0lBQUQsQ0FwQkEsQUFvQkMsQ0FwQmdDLElBQUksQ0FBQyxRQUFRLEdBb0I3QztJQXBCWSxnQkFBVyxjQW9CdkIsQ0FBQTtBQUNMLENBQUMsRUF0Qk0sSUFBSSxLQUFKLElBQUksUUFzQlY7QUN0QkQsSUFBTyxJQUFJLENBNkVWO0FBN0VELFdBQU8sSUFBSTtJQUNQO1FBQThCLDRCQUFXO1FBUXJDLHFDQUFxQztRQUVyQyxrQkFBWSxLQUFlO1lBQTNCLFlBQ0ksaUJBQU8sU0E0QlY7WUFqQ08sYUFBTyxHQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQU1sQyxLQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztZQUVuQixJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQztZQUN2QyxJQUFJLE1BQU0sR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQztZQUV6QyxLQUFJLENBQUMsS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2pDLEtBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUNuQyxLQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssR0FBRyxHQUFHLEVBQUUsQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNoRSxLQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBRXJCLE9BQU87WUFDUCxJQUFJLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMvQixJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxHQUFHLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDMUQsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBR2YsUUFBUTtZQUNSLElBQUksS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN0QyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztZQUNsQixLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMzQixLQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztZQUduQixLQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXZDLEtBQUksQ0FBQyxVQUFVLENBQUMsS0FBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDOztRQUNsQyxDQUFDO1FBRUQsNkJBQVUsR0FBVixVQUFXLE1BQWdCO1lBQ3ZCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzlCLENBQUM7UUFFRCx5QkFBTSxHQUFOO1lBQ0ksSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNkLE9BQU87YUFDVjtZQUNELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1lBRXBCLElBQUksZUFBZSxHQUFHLEdBQUcsQ0FBQztZQUMxQixRQUFRLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLGVBQWUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3JGLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLGVBQWUsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsYUFBYSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLGNBQWMsRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUUvUCxDQUFDO1FBRUQsMkJBQVEsR0FBUjtZQUNJLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN6RCxDQUFDO1FBRUQseUJBQU0sR0FBTjtZQUNJLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQ3RDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2xDLENBQUM7UUFFRCxpQ0FBYyxHQUFkO1lBRUksSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDckIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFFOUIsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLGFBQWEsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7UUFDaEgsQ0FBQztRQUNMLGVBQUM7SUFBRCxDQTNFQSxBQTJFQyxDQTNFNkIsSUFBSSxDQUFDLE1BQU0sR0EyRXhDO0lBM0VZLGFBQVEsV0EyRXBCLENBQUE7QUFDTCxDQUFDLEVBN0VNLElBQUksS0FBSixJQUFJLFFBNkVWO0FDN0VELElBQU8sSUFBSSxDQW1DVjtBQW5DRCxXQUFPLElBQUk7SUFDUDtRQUErQiw2QkFBVztRQUl0QyxtQkFBWSxLQUFlO1lBQTNCLFlBQ0ksa0JBQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsU0FtQjVCO1lBbEJHLEtBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBR25CLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ3hCLElBQUksVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztnQkFDekQsVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBRTNCLElBQUksRUFBRSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUM3QyxFQUFFLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDO2dCQUN0QyxFQUFFLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDO2dCQUN4QyxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFFbkIsSUFBSSxTQUFTLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ3JDLFNBQVMsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxDQUFDO2dCQUNuQyxTQUFTLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDO2dCQUVwRCxLQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2FBQzVCOztRQUNMLENBQUM7UUFFRCwwQkFBTSxHQUFOLFVBQU8sR0FBYTtZQUFwQixpQkFLQztZQUpHLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBcUIsRUFBRSxDQUFDO2dCQUMzQyxJQUFJLFFBQVEsR0FBRyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBYyxDQUFDO2dCQUNoRCxRQUFRLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdkMsQ0FBQyxDQUFDLENBQUE7UUFDTixDQUFDO1FBRUwsZ0JBQUM7SUFBRCxDQWpDQSxBQWlDQyxDQWpDOEIsSUFBSSxDQUFDLE1BQU0sR0FpQ3pDO0lBakNZLGNBQVMsWUFpQ3JCLENBQUE7QUFDTCxDQUFDLEVBbkNNLElBQUksS0FBSixJQUFJLFFBbUNWIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUgQXBwIHtcbiAgICBleHBvcnQgY2xhc3MgQ29uc3RhbnRzIHtcbiAgICAgICAgcHVibGljIHN0YXRpYyBTWU1CT0xfV0lEVEggPSAyMDA7XG4gICAgICAgIHB1YmxpYyBzdGF0aWMgU1lNQk9MX0hFSUdIVCA9IDEwMDtcbiAgICB9XG59IiwibW9kdWxlIEFwcCB7XG4gICAgZXhwb3J0IGNsYXNzIE1haW4ge1xuXG4gICAgICAgIHByaXZhdGUgYXBwOiBQSVhJLkFwcGxpY2F0aW9uO1xuXG4gICAgICAgIHByaXZhdGUgcmVlbFZpZXc6IHZpZXcuUmVlbFZpZXc7XG4gICAgICAgIHByaXZhdGUgc3BpbkJ0bjogUElYSS5EaXNwbGF5T2JqZWN0O1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuXG4gICAgICAgICAgICB0aGlzLmluaXRQSVhJKCk7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0TG9hZGluZygpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBwcml2YXRlIGluaXRQSVhJKCkge1xuICAgICAgICAgICAgdGhpcy5hcHAgPSBuZXcgUElYSS5BcHBsaWNhdGlvbih3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0LCB7IGJhY2tncm91bmRDb2xvcjogMHgxMDk5YmIgfSk7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuYXBwLnZpZXcpO1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5vblJlc2l6ZS5iaW5kKHRoaXMpLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG9uUmVzaXplKCkge1xuICAgICAgICAgICAgdGhpcy5hcHAucmVuZGVyZXIucmVzaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXG4gICAgICAgICAgICB0aGlzLnJlZWxWaWV3LnggPSB0aGlzLmFwcC5zY3JlZW4ud2lkdGggLyAyO1xuICAgICAgICAgICAgdGhpcy5yZWVsVmlldy55ID0gdGhpcy5hcHAuc2NyZWVuLmhlaWdodCAvIDI7XG5cbiAgICAgICAgICAgIHRoaXMuc3BpbkJ0bi54ID0gdGhpcy5yZWVsVmlldy54O1xuICAgICAgICAgICAgdGhpcy5zcGluQnRuLnkgPSB0aGlzLnJlZWxWaWV3LnkgKyBBcHAuQ29uc3RhbnRzLlNZTUJPTF9IRUlHSFQ7XG4gICAgICAgIH1cblxuICAgICAgICBzdGFydExvYWRpbmcoKTogYW55IHtcbiAgICAgICAgICAgIGxldCBsb2FkaW5nVmlldyA9IG5ldyB2aWV3LkxvYWRpbmdWaWV3KCk7XG4gICAgICAgICAgICBsb2FkaW5nVmlldy54ID0gdGhpcy5hcHAuc2NyZWVuLndpZHRoIC8gMjtcbiAgICAgICAgICAgIGxvYWRpbmdWaWV3LnkgPSB0aGlzLmFwcC5zY3JlZW4uaGVpZ2h0IC8gMjtcblxuICAgICAgICAgICAgdGhpcy5hcHAuc3RhZ2UuYWRkQ2hpbGQobG9hZGluZ1ZpZXcpO1xuXG4gICAgICAgICAgICBQSVhJLmxvYWRlclxuICAgICAgICAgICAgICAgIC5vbihcInByb2dyZXNzXCIsIChsb2FkZXI6IFBJWEkubG9hZGVycy5Mb2FkZXIsIHJlc291cmNlOiBQSVhJLmxvYWRlcnMuUmVzb3VyY2UpID0+IHsgbG9hZGluZ1ZpZXcudXBkYXRlUHJvZ3Jlc3MobG9hZGVyLnByb2dyZXNzKSB9KVxuICAgICAgICAgICAgICAgIC5hZGQoXCJzaG9wc1wiLCBcInJlc291cmNlL3Nob3BzLmpzb25cIilcbiAgICAgICAgICAgICAgICAubG9hZCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdWaWV3LnBhcmVudC5yZW1vdmVDaGlsZChsb2FkaW5nVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25Mb2FkZWQoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgb25Mb2FkZWQoKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRSZWVsVmlldyhQSVhJLmxvYWRlci5yZXNvdXJjZXMuc2hvcHMuZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmluaXRTcGluQnV0dG9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpbml0UmVlbFZpZXcoc2hvcHM6IHN0cmluZ1tdKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzaG9wcyk7XG4gICAgICAgICAgICBsZXQgcmVlbCA9IG5ldyB2aWV3LlJlZWxWaWV3KHNob3BzKTtcbiAgICAgICAgICAgIHJlZWwueCA9IHRoaXMuYXBwLnNjcmVlbi53aWR0aCAvIDI7XG4gICAgICAgICAgICByZWVsLnkgPSB0aGlzLmFwcC5zY3JlZW4uaGVpZ2h0IC8gMjtcblxuICAgICAgICAgICAgdGhpcy5hcHAuc3RhZ2UuYWRkQ2hpbGQocmVlbCk7XG5cbiAgICAgICAgICAgIHRoaXMucmVlbFZpZXcgPSByZWVsO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5pdFNwaW5CdXR0b24oKSB7XG4gICAgICAgICAgICBsZXQgYnRuID0gbmV3IHZpZXcuQnV0dG9uKFwi6ZaL5aeLXCIpO1xuICAgICAgICAgICAgYnRuLmFuY2hvci5zZXQoMC41KTtcbiAgICAgICAgICAgIGJ0bi54ID0gdGhpcy5yZWVsVmlldy54O1xuICAgICAgICAgICAgYnRuLnkgPSB0aGlzLnJlZWxWaWV3LnkgKyBBcHAuQ29uc3RhbnRzLlNZTUJPTF9IRUlHSFQ7XG4gICAgICAgICAgICBidG4uYnV0dG9uV2lkdGggPSBBcHAuQ29uc3RhbnRzLlNZTUJPTF9XSURUSDtcbiAgICAgICAgICAgIGJ0bi5idXR0b25IZWlnaHQgPSA1NTtcbiAgICAgICAgICAgIC8vIGJ0bi54ID0gdGhpcy5hcHAuc2NyZWVuLndpZHRoIC0gNjQ7XG4gICAgICAgICAgICAvLyBidG4ueSA9IHRoaXMuYXBwLnNjcmVlbi5oZWlnaHQgLSA0ODtcbiAgICAgICAgICAgIGJ0bi5pbnRlcmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBidG4ub24oJ3BvaW50ZXJ1cCcsIHRoaXMuc3Bpbi5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgdGhpcy5zcGluQnRuID0gYnRuO1xuXG4gICAgICAgICAgICB0aGlzLmFwcC5zdGFnZS5hZGRDaGlsZChidG4pO1xuXG5cbiAgICAgICAgICAgIC8vIGxldCB0ZXN0QnRuID0gbmV3IHZpZXcuQnV0dG9uKCk7XG4gICAgICAgICAgICAvLyB0ZXN0QnRuLmJ1dHRvbldpZHRoID0gQXBwLkNvbnN0YW50cy5TWU1CT0xfV0lEVEg7XG4gICAgICAgICAgICAvLyB0ZXN0QnRuLmJ1dHRvbkhlaWdodCA9IDc1O1xuICAgICAgICAgICAgLy8gLy8gdGVzdEJ0bi5yZWRyYXcoKTtcblxuICAgICAgICAgICAgLy8gdGVzdEJ0bi54ID0gdGhpcy5yZWVsVmlldy54O1xuICAgICAgICAgICAgLy8gdGVzdEJ0bi55ID0gdGhpcy5yZWVsVmlldy55ICsgQXBwLkNvbnN0YW50cy5TWU1CT0xfSEVJR0hUICoyO1xuICAgICAgICAgICAgLy8gdGhpcy5hcHAuc3RhZ2UuYWRkQ2hpbGQodGVzdEJ0bik7XG4gICAgICAgIH1cblxuICAgICAgICBzcGluKCkge1xuICAgICAgICAgICAgdGhpcy5yZWVsVmlldy5vblNwaW4oKTtcbiAgICAgICAgfVxuXG5cbiAgICB9XG59XG4iLCJtb2R1bGUgdmlldyB7XG4gICAgZXhwb3J0IGVudW0gSG92ZXJUeXBlIHtcbiAgICAgICAgdHlwZTFcbiAgICB9XG5cbiAgICBleHBvcnQgY2xhc3MgQnV0dG9uSG92ZXJFZmZlY3Qge1xuXG4gICAgICAgIHB1YmxpYyBzdGF0aWMgb25Ib3Zlcih0eXBlOiBIb3ZlclR5cGUsIHR3ZWVuT2JqOiBQSVhJLkRpc3BsYXlPYmplY3QsIGlzT3ZlckluOiBib29sZWFuKSB7XG5cbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgSG92ZXJUeXBlLnR5cGUxOlxuICAgICAgICAgICAgICAgICAgICBCdXR0b25Ib3ZlckVmZmVjdC5hbHBoYVZpc2libGUodHdlZW5PYmosIGlzT3ZlckluKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cblxuICAgICAgICBwcml2YXRlIHN0YXRpYyBhbHBoYVZpc2libGUodHdlZW5PYmo6IFBJWEkuRGlzcGxheU9iamVjdCwgaXNPdmVySW46IGJvb2xlYW4pIHtcbiAgICAgICAgICAgIGxldCBzZWMgPSAwLjU7XG4gICAgICAgICAgICBUd2VlbkxpdGUua2lsbFR3ZWVuc09mKHR3ZWVuT2JqKTtcblxuICAgICAgICAgICAgaWYgKGlzT3ZlckluKSB7XG4gICAgICAgICAgICAgICAgVHdlZW5MaXRlLnRvKHR3ZWVuT2JqLCBzZWMsIHsgYWxwaGE6IDEgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFR3ZWVuTGl0ZS50byh0d2Vlbk9iaiwgc2VjLCB7IGFscGhhOiAwLCBvbkNvbXBsZXRlOiAoKSA9PiB7IHR3ZWVuT2JqLnZpc2libGUgPSBmYWxzZSB9IH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgIH1cbn0iLCJtb2R1bGUgdmlldyB7XG5cbiAgICBleHBvcnQgY2xhc3MgQnV0dG9uIGV4dGVuZHMgUElYSS5TcHJpdGUge1xuXG4gICAgICAgIGhvdmVyVHlwZTogSG92ZXJUeXBlID0gSG92ZXJUeXBlLnR5cGUxO1xuXG5cbiAgICAgICAgZnJhbWVDb2xvciA9IDB4ZmZmZmZmO1xuICAgICAgICBiZ0NvbG9yID0gMHgwMDExZmY7XG5cbiAgICAgICAgbGFiZWw6IFBJWEkuVGV4dDtcbiAgICAgICAgcHJpdmF0ZSBiZ1ZpZXc6IFBJWEkuR3JhcGhpY3M7XG5cbiAgICAgICAgX2J1dHRvbldpZHRoOiBudW1iZXI7XG4gICAgICAgIF9idXR0b25IZWlnaHQ6IG51bWJlcjtcblxuICAgICAgICBwcml2YXRlIGVmZmVjdFNlYyA9IDAuNTtcbiAgICAgICAgcHJpdmF0ZSBlZmZlY3Q6IFBJWEkuU3ByaXRlO1xuXG4gICAgICAgIHByaXZhdGUgY3VycmVudFR3ZWVuOiBUd2VlbkxpdGU7XG5cbiAgICAgICAgY29uc3RydWN0b3IodGV4dCA9IFwiQnV0dG9uXCIpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgICAgIHRoaXMuYmdWaWV3ID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcblxuICAgICAgICAgICAgdGhpcy5lZmZlY3QgPSBuZXcgUElYSS5TcHJpdGUoUElYSS5UZXh0dXJlLldISVRFKTtcbiAgICAgICAgICAgIHRoaXMuZWZmZWN0LmFuY2hvci5zZXQoMC41KTtcbiAgICAgICAgICAgIHRoaXMuZWZmZWN0LnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZWZmZWN0LmFscGhhID0gMDtcblxuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IG5ldyBQSVhJLlRleHQodGV4dCwgeyBmaWxsOiB0aGlzLmZyYW1lQ29sb3IgfSk7XG4gICAgICAgICAgICB0aGlzLmxhYmVsLmFuY2hvci5zZXQoMC41KTtcblxuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLmJnVmlldywgdGhpcy5lZmZlY3QsIHRoaXMubGFiZWwpO1xuXG4gICAgICAgICAgICB0aGlzLmRyYXdOb3JtYWxTeXRsZSgpO1xuXG4gICAgICAgICAgICAvLyBzZXQgaW50ZXJhY3RpdmVcbiAgICAgICAgICAgIHRoaXMuaW50ZXJhY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5idXR0b25Nb2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMub24oXCJwb2ludGVyb3ZlclwiLCB0aGlzLm9uQnV0dG9uT3Zlcik7XG4gICAgICAgICAgICB0aGlzLm9uKFwicG9pbnRlcm91dFwiLCB0aGlzLm9uQnV0dG9uT3V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRyYXdOb3JtYWxTeXRsZSgpIHtcbiAgICAgICAgICAgIC8vIGxldCB3aWR0aCA9IHRoaXMud2lkdGg7XG4gICAgICAgICAgICAvLyBsZXQgaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7XG4gICAgICAgICAgICBsZXQgcGFkZGluZyA9IDEwO1xuICAgICAgICAgICAgbGV0IHdpZHRoID0gdGhpcy5fYnV0dG9uV2lkdGggfHwgdGhpcy5sYWJlbC53aWR0aCArIHBhZGRpbmc7XG4gICAgICAgICAgICBsZXQgaGVpZ2h0ID0gdGhpcy5fYnV0dG9uSGVpZ2h0IHx8IHRoaXMubGFiZWwuaGVpZ2h0ICsgcGFkZGluZztcblxuICAgICAgICAgICAgLy8gbGV0IHN0YXJ0WCA9ICAtd2lkdGggKiAwLjU7XG4gICAgICAgICAgICAvLyBsZXQgc3RhcnRZID0gLWhlaWdodCAqIDAuNTtcbiAgICAgICAgICAgIGxldCBzdGFydFggPSAtd2lkdGggKiAwLjU7XG4gICAgICAgICAgICBsZXQgc3RhcnRZID0gLWhlaWdodCAqIDAuNTtcblxuICAgICAgICAgICAgbGV0IGdyYXBoID0gdGhpcy5iZ1ZpZXc7XG4gICAgICAgICAgICBncmFwaC5jbGVhcigpO1xuICAgICAgICAgICAgZ3JhcGguYmVnaW5GaWxsKHRoaXMuYmdDb2xvcik7XG4gICAgICAgICAgICAvLyBncmFwaC5kcmF3UmVjdChzdGFydFgsc3RhcnRZLHdpZHRoLGhlaWdodCk7XG4gICAgICAgICAgICAvLyBncmFwaC5lbmRGaWxsKCk7XG5cbiAgICAgICAgICAgIGdyYXBoLmxpbmVTdHlsZSg1LCB0aGlzLmZyYW1lQ29sb3IpO1xuXG4gICAgICAgICAgICBncmFwaC5tb3ZlVG8oc3RhcnRYLCBzdGFydFkpO1xuICAgICAgICAgICAgZ3JhcGgubGluZVRvKHN0YXJ0WCArIHdpZHRoLCBzdGFydFkpO1xuICAgICAgICAgICAgZ3JhcGgubGluZVRvKHN0YXJ0WCArIHdpZHRoLCBzdGFydFkgKyBoZWlnaHQpO1xuICAgICAgICAgICAgZ3JhcGgubGluZVRvKHN0YXJ0WCwgc3RhcnRZICsgaGVpZ2h0KTtcbiAgICAgICAgICAgIGdyYXBoLmxpbmVUbyhzdGFydFgsIHN0YXJ0WSk7XG5cbiAgICAgICAgICAgIGdyYXBoLmVuZEZpbGwoKTtcblxuXG4gICAgICAgIH1cblxuICAgICAgICBzZXQgYnV0dG9uV2lkdGgod2lkdGg6IG51bWJlcikge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uV2lkdGggPSBNYXRoLm1heCh3aWR0aCwgdGhpcy5sYWJlbC53aWR0aCk7XG4gICAgICAgICAgICB0aGlzLnJlZHJhdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0IGJ1dHRvbkhlaWdodChoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uSGVpZ2h0ID0gTWF0aC5tYXgoaGVpZ2h0LCB0aGlzLmxhYmVsLmhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnJlZHJhdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVkcmF3KCkge1xuICAgICAgICAgICAgdGhpcy5kcmF3Tm9ybWFsU3l0bGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9uQnV0dG9uT3ZlcigpIHtcbiAgICAgICAgICAgIHRoaXMuZWZmZWN0LndpZHRoID0gdGhpcy5fYnV0dG9uV2lkdGg7XG4gICAgICAgICAgICB0aGlzLmVmZmVjdC5oZWlnaHQgPSB0aGlzLl9idXR0b25IZWlnaHQ7XG5cbiAgICAgICAgICAgIHRoaXMuZWZmZWN0LnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lZmZlY3QudGludCA9IHRoaXMuZnJhbWVDb2xvcjtcblxuXG4gICAgICAgICAgICBCdXR0b25Ib3ZlckVmZmVjdC5vbkhvdmVyKHRoaXMuaG92ZXJUeXBlLHRoaXMuZWZmZWN0LHRydWUpO1xuXG4gICAgICAgICAgICB0aGlzLmxhYmVsLnN0eWxlLmZpbGwgPSB0aGlzLmJnQ29sb3I7XG4gICAgICAgIH1cblxuICAgICAgICBvbkJ1dHRvbk91dCgpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQnV0dG9uSG92ZXJFZmZlY3Qub25Ib3Zlcih0aGlzLmhvdmVyVHlwZSx0aGlzLmVmZmVjdCxmYWxzZSk7XG5cbiAgICAgICAgICAgIHRoaXMubGFiZWwuc3R5bGUuZmlsbCA9IHRoaXMuZnJhbWVDb2xvcjtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJtb2R1bGUgdmlldyB7XG4gICAgZXhwb3J0IGNsYXNzIExvYWRpbmdWaWV3IGV4dGVuZHMgUElYSS5HcmFwaGljcyB7XG5cbiAgICAgICAgcHJpdmF0ZSBwcm9ncmVzczogbnVtYmVyID0gMDtcbiAgICAgICAgY29sb3I6IG51bWJlciA9IDB4YWFiYzEzXG5cbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgcHVibGljIHVwZGF0ZVByb2dyZXNzKHA6IG51bWJlcikge1xuICAgICAgICAgICAgbGV0IHBlcmNlbnQgPSBwO1xuICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHBlcmNlbnQ7XG5cbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMubGluZVN0eWxlKDEwLCB0aGlzLmNvbG9yKTtcbiAgICAgICAgICAgIC8vIHRoaXMuZHJhd0NpcmNsZSgwLCAwLCAyICogTWF0aC5QSSAqIHBlcmNlbnQpO1xuICAgICAgICAgICAgdGhpcy5hcmMoMCwgMCwgNTAsIDAsIDIgKiBNYXRoLlBJICogcGVyY2VudCk7XG4gICAgICAgICAgICB0aGlzLmVuZEZpbGwoKTtcbiAgICAgICAgfVxuXG4gICAgfVxufVxuIiwibW9kdWxlIHZpZXcge1xuICAgIGV4cG9ydCBjbGFzcyBSZWVsVmlldyBleHRlbmRzIFBJWEkuU3ByaXRlIHtcblxuICAgICAgICBwcml2YXRlIGZyYW1lOiBQSVhJLkdyYXBoaWNzO1xuICAgICAgICBwcml2YXRlIHdoZWVsOiB2aWV3LldoZWVsVmlldztcbiAgICAgICAgcHJpdmF0ZSBzaG9wczogc3RyaW5nW107XG5cbiAgICAgICAgcHJpdmF0ZSB0ZW1wSWRzOiBudW1iZXJbXSA9IFswLCAxLCAyXTtcbiAgICAgICAgc3BpbmluZzogYm9vbGVhbjtcbiAgICAgICAgLy8gcHJpdmF0ZSBfbWFzazogUElYSS5EaXNwbGF5T2JqZWN0O1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHNob3BzOiBzdHJpbmdbXSkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc2hvcHMgPSBzaG9wcztcblxuICAgICAgICAgICAgbGV0IHdpZHRoID0gQXBwLkNvbnN0YW50cy5TWU1CT0xfV0lEVEg7XG4gICAgICAgICAgICBsZXQgaGVpZ2h0ID0gQXBwLkNvbnN0YW50cy5TWU1CT0xfSEVJR0hUO1xuXG4gICAgICAgICAgICB0aGlzLmZyYW1lID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICAgICAgICAgIHRoaXMuZnJhbWUubGluZVN0eWxlKDEwLCAweDAwMDAwMCk7XG4gICAgICAgICAgICB0aGlzLmZyYW1lLmRyYXdSZWN0KC13aWR0aCAqIDAuNSwgLWhlaWdodCAqIDAuNSwgd2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLmZyYW1lLmVuZEZpbGwoKTtcblxuICAgICAgICAgICAgLy8gbWFza1xuICAgICAgICAgICAgbGV0IG1hc2sgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgICAgICAgICAgbWFzay5iZWdpbkZpbGwoMHhGRkZGRkYpO1xuICAgICAgICAgICAgbWFzay5kcmF3UmVjdCgtd2lkdGggKiAwLjUsIC1oZWlnaHQgKiAwLjUsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgICAgbWFzay5lbmRGaWxsKCk7XG5cblxuICAgICAgICAgICAgLy8gd2hlZWxcbiAgICAgICAgICAgIGxldCB3aGVlbCA9IG5ldyB2aWV3LldoZWVsVmlldyhzaG9wcyk7XG4gICAgICAgICAgICB3aGVlbC5tYXNrID0gbWFzaztcbiAgICAgICAgICAgIHdoZWVsLnNldElkcyh0aGlzLnRlbXBJZHMpO1xuICAgICAgICAgICAgdGhpcy53aGVlbCA9IHdoZWVsO1xuXG5cbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQod2hlZWwsIG1hc2ssIHRoaXMuZnJhbWUpO1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNob3AodGhpcy50ZW1wSWRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHVwZGF0ZVNob3Aoc2hvcElkOiBudW1iZXJbXSkge1xuICAgICAgICAgICAgdGhpcy53aGVlbC5zZXRJZHMoc2hvcElkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9uU3BpbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwaW5pbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNwaW5pbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBsZXQgZGFtcGluZ1N0YXJ0U2VjID0gMC41O1xuICAgICAgICAgICAgVHdlZW5NYXgudG8odGhpcy53aGVlbC5wb3NpdGlvbiwgZGFtcGluZ1N0YXJ0U2VjLCB7IHk6IC00MCwgeW95bzogdHJ1ZSwgcmVwZWF0OiAxIH0pO1xuICAgICAgICAgICAgVHdlZW5NYXguZnJvbVRvKHRoaXMud2hlZWwucG9zaXRpb24sIDAuMiwgeyB5OiAwIH0sIHsgZGVsYXk6IGRhbXBpbmdTdGFydFNlYyAqIDIsIHk6IEFwcC5Db25zdGFudHMuU1lNQk9MX0hFSUdIVCwgcmVwZWF0OiAxMCwgZWFzZTogTGluZWFyLmVhc2VOb25lLCBvblJlcGVhdDogdGhpcy5zd2FwSWQsIG9uUmVwZWF0U2NvcGU6IHRoaXMsIG9uQ29tcGxldGU6IHRoaXMub25TcGluQ29tcGxldGUsIG9uQ29tcGxldGVTY29wZTogdGhpcyB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmFuZG9tSWQoKTogbnVtYmVyIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLnNob3BzLmxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBzd2FwSWQoKSB7XG4gICAgICAgICAgICB0aGlzLnRlbXBJZHMudW5zaGlmdCh0aGlzLnJhbmRvbUlkKCkpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTaG9wKHRoaXMudGVtcElkcyk7XG4gICAgICAgIH1cblxuICAgICAgICBvblNwaW5Db21wbGV0ZSgpIHtcblxuICAgICAgICAgICAgdGhpcy5zcGluaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnRlbXBJZHMudW5zaGlmdCh0aGlzLnJhbmRvbUlkKCkpO1xuICAgICAgICAgICAgdGhpcy50ZW1wSWRzLnVuc2hpZnQodGhpcy5yYW5kb21JZCgpKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2hvcCh0aGlzLnRlbXBJZHMpO1xuXG4gICAgICAgICAgICBUd2VlbkxpdGUuZnJvbVRvKHRoaXMud2hlZWwucG9zaXRpb24sIDEsIHsgeTogLUFwcC5Db25zdGFudHMuU1lNQk9MX0hFSUdIVCB9LCB7IHk6IDAsIGVhc2U6IEJhY2suZWFzZU91dCB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJtb2R1bGUgdmlldyB7XG4gICAgZXhwb3J0IGNsYXNzIFdoZWVsVmlldyBleHRlbmRzIFBJWEkuU3ByaXRlIHtcblxuICAgICAgICBwcml2YXRlIHNob3BzOiBzdHJpbmdbXTtcblxuICAgICAgICBjb25zdHJ1Y3RvcihzaG9wczogc3RyaW5nW10pIHtcbiAgICAgICAgICAgIHN1cGVyKFBJWEkuVGV4dHVyZS5FTVBUWSk7XG4gICAgICAgICAgICB0aGlzLnNob3BzID0gc2hvcHM7XG5cblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgc3ltYm9sVGV4dCA9IG5ldyBQSVhJLlRleHQoXCJcIiwgeyBmaWxsOiBcIjB4MDAwMDAwXCIgfSk7XG4gICAgICAgICAgICAgICAgc3ltYm9sVGV4dC5hbmNob3Iuc2V0KDAuNSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgYmcgPSBuZXcgUElYSS5TcHJpdGUoUElYSS5UZXh0dXJlLldISVRFKTtcbiAgICAgICAgICAgICAgICBiZy53aWR0aCA9IEFwcC5Db25zdGFudHMuU1lNQk9MX1dJRFRIO1xuICAgICAgICAgICAgICAgIGJnLmhlaWdodCA9IEFwcC5Db25zdGFudHMuU1lNQk9MX0hFSUdIVDtcbiAgICAgICAgICAgICAgICBiZy5hbmNob3Iuc2V0KDAuNSk7XG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmFkZENoaWxkKGJnLCBzeW1ib2xUZXh0KTtcbiAgICAgICAgICAgICAgICBjb250YWluZXIueSA9IChpIC0gMSkgKiBBcHAuQ29uc3RhbnRzLlNZTUJPTF9IRUlHSFQ7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBzZXRJZHMoaWRzOiBudW1iZXJbXSkge1xuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZDogUElYSS5Db250YWluZXIsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgdGV4dFZpZXcgPSBjaGlsZC5nZXRDaGlsZEF0KDEpIGFzIFBJWEkuVGV4dDtcbiAgICAgICAgICAgICAgICB0ZXh0Vmlldy50ZXh0ID0gdGhpcy5zaG9wc1tpZHNbaV1dO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfVxufSJdfQ==
